<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carto - Malakoff Humanis</title>

    <!-- CSS - v1.0.94 cache bust -->
    <link rel="stylesheet" href="../css/variables.css?v=1.3.0">
    <link rel="stylesheet" href="../css/base.css?v=1.3.0">
    <link rel="stylesheet" href="../css/components.css?v=1.3.0">
    <link rel="stylesheet" href="../css/notifications.css?v=1.3.0">
    <link rel="stylesheet" href="../css/app.css?v=1.3.0">
    <link rel="stylesheet" href="../css/dashboard.css?v=1.3.0">
    <link rel="stylesheet" href="../css/table.css?v=1.3.0">
    <link rel="stylesheet" href="../css/process-matrix.css?v=1.3.0">
    <link rel="stylesheet" href="../css/mae.css?v=1.3.0">
</head>
<body class="fullscreen-app">
    <!-- Badge environnement -->
    <div id="envBadge" class="env-badge"></div>

    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <!-- Bouton hamburger en haut -->
            <div class="sidebar-toggle-row">
                <button id="btnToggleSidebar" class="sidebar-toggle-btn" title="Réduire/Agrandir le menu">
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                </button>
            </div>

            <!-- Header Sidebar avec Logo et Titre -->
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <img src="../assets/images/logo-mh.png" alt="MH">
                </div>
                <span class="sidebar-brand">Carto</span>
            </div>

            <!-- Navigation -->
            <nav class="sidebar-nav" id="sidebarNav">
                <!-- Section Fonctionnel -->
                <div class="nav-section">
                    <div class="nav-section-title"><span>Fonctionnel</span></div>
                    <div class="nav-item active" data-page="migration" data-tooltip="Cartographie">
                        <span class="nav-item-icon">&#128640;</span>
                        <span class="nav-item-text">Cartographie</span>
                    </div>
                    <div class="nav-item" data-page="parc" data-tooltip="Parc Applicatif">
                        <span class="nav-item-icon">&#128202;</span>
                        <span class="nav-item-text">Parc Applicatif</span>
                    </div>
                    <div class="nav-item" data-page="roadmap-chantiers" data-tooltip="Roadmap">
                        <span class="nav-item-icon">&#128197;</span>
                        <span class="nav-item-text">Roadmap</span>
                    </div>
                    <div class="nav-item" data-page="mae" data-tooltip="MAE">
                        <span class="nav-item-icon">&#128203;</span>
                        <span class="nav-item-text">MAE</span>
                    </div>
                </div>

                <!-- Section Paramètres -->
                <div class="nav-section">
                    <div class="nav-section-title"><span>Paramètres</span></div>
                    <div class="nav-item" data-page="params" data-table="FLUX" data-tooltip="Flux Migration">
                        <span class="nav-item-icon">&#128640;</span>
                        <span class="nav-item-text">Flux Migration</span>
                    </div>
                    <div class="nav-item" data-page="params" data-table="ACTEURS" data-tooltip="Acteurs">
                        <span class="nav-item-icon">&#128100;</span>
                        <span class="nav-item-text">Acteurs</span>
                    </div>
                    <div class="nav-item" data-page="params" data-table="EQUIPES" data-tooltip="Équipes">
                        <span class="nav-item-icon">&#128101;</span>
                        <span class="nav-item-text">Équipes</span>
                    </div>
                    <div class="nav-item" data-page="params" data-table="TABLES_MH" data-tooltip="Tables MHTech">
                        <span class="nav-item-icon">&#128451;</span>
                        <span class="nav-item-text">Tables MHTech</span>
                    </div>
                    <div class="nav-item" data-page="params" data-table="SHORES" data-tooltip="Shores / Golds">
                        <span class="nav-item-icon">&#128451;</span>
                        <span class="nav-item-text">Shores / Golds</span>
                    </div>
                    <div class="nav-item" data-page="params" data-table="PROJETS_DSS" data-tooltip="Projets DSS">
                        <span class="nav-item-icon">&#128194;</span>
                        <span class="nav-item-text">Projets DSS</span>
                    </div>
                    <div class="nav-item" data-page="params" data-table="DATAFLOWS" data-tooltip="Dataflows">
                        <span class="nav-item-icon">&#128260;</span>
                        <span class="nav-item-text">Dataflows</span>
                    </div>
                    <div class="nav-item" data-page="params" data-table="PROCESSUS" data-tooltip="Processus">
                        <span class="nav-item-icon">&#128736;</span>
                        <span class="nav-item-text">Processus</span>
                    </div>
                    <div class="nav-item" data-page="params" data-table="PERIMETRES" data-tooltip="Périmètres">
                        <span class="nav-item-icon">&#127758;</span>
                        <span class="nav-item-text">Périmètres</span>
                    </div>
                    <div class="nav-item" data-page="params" data-table="SPRINTS" data-tooltip="Sprints">
                        <span class="nav-item-icon">&#128197;</span>
                        <span class="nav-item-text">Sprints</span>
                    </div>
                    <div class="nav-item" data-page="params" data-table="CAPACITE" data-tooltip="Capacité">
                        <span class="nav-item-icon">&#128200;</span>
                        <span class="nav-item-text">Capacité</span>
                    </div>
                    <div class="nav-item" data-page="params" data-table="CHANTIER" data-tooltip="Chantiers">
                        <span class="nav-item-icon">&#128736;</span>
                        <span class="nav-item-text">Chantiers</span>
                    </div>
                    <div class="nav-item" data-page="params" data-table="PHASES" data-tooltip="Phases">
                        <span class="nav-item-icon">&#128197;</span>
                        <span class="nav-item-text">Phases</span>
                    </div>
                    <div class="nav-item" data-page="params" data-table="DATAANA" data-tooltip="DataAna">
                        <span class="nav-item-icon">&#128202;</span>
                        <span class="nav-item-text">DataAna</span>
                    </div>
                </div>
            </nav>
        </aside>

        <!-- Overlay mobile -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="main-header">
                <div class="main-header-left">
                    <button class="mobile-menu-toggle" id="btnMobileMenu">
                        <span>&#9776;</span>
                    </button>
                    <div class="page-title-container">
                        <h1 class="page-title" id="pageTitle">Cartographie</h1>
                        <p class="page-subtitle" id="pageSubtitle">Vue d'ensemble de la migration</p>
                    </div>
                </div>
                <div class="main-header-center">
                    <!-- Indicateur de connexion -->
                    <div id="connectionStatus" class="connection-status connected" title="Connecté à Excel">
                        <span class="connection-dot"></span>
                        <span class="connection-text">Connecté</span>
                        <span class="connection-sync"></span>
                    </div>
                </div>
                <div class="main-header-right">
                    <button id="btnRefresh" class="btn btn-secondary btn-sm" title="Actualiser">
                        <span>&#8635;</span> Actualiser
                    </button>
                    <button id="btnCloseApp" class="btn btn-secondary btn-sm" title="Fermer">
                        <span>&#10005;</span> Fermer
                    </button>
                </div>
            </header>

            <!-- Zone de contenu dynamique -->
            <div class="main-body">
                <div class="page-container" id="pageContainer">
                    <!-- Contenu chargé dynamiquement -->
                    <div class="loading-overlay" id="loadingOverlay">
                        <div class="spinner spinner-lg"></div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="main-footer">
                <p>&copy; 2026 Malakoff Humanis - Carto v<span id="appVersion">1.2.0</span></p>
            </footer>
        </main>
    </div>

    <!-- Container pour les modales -->
    <div id="modalContainer"></div>

    <!-- Container pour les notifications -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- JavaScript - v1.0.116 cache bust -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.1/jspdf.plugin.autotable.min.js"></script>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script src="../js/config.js?v=1.3.0"></script>
    <script src="../js/utils/helpers.js?v=1.3.0"></script>
    <script src="../js/utils/notifications.js?v=1.3.0"></script>
    <script src="../js/utils/persistent-cache.js?v=1.3.0"></script>
    <script src="../js/utils/excel-bridge.js?v=1.3.0"></script>
    <script src="../js/components/sidebar.js?v=1.3.0"></script>
    <script src="../js/components/modal.js?v=1.3.0"></script>
    <script src="../js/components/form.js?v=1.3.0"></script>
    <script src="../js/components/phase-modal.js?v=1.3.0"></script>
    <script src="../js/components/chantier-modal.js?v=1.3.0"></script>
    <script src="../js/components/mae-modal.js?v=1.3.0"></script>
    <script src="../js/components/table.js?v=1.3.0"></script>
    <script src="../js/components/chart.js?v=1.3.0"></script>
    <script src="../js/pages/migration.js?v=1.3.0"></script>
    <script src="../js/pages/parc.js?v=1.3.0"></script>
    <script src="../js/pages/roadmap.js?v=1.3.0"></script>
    <script src="../js/pages/roadmap-gantt.js?v=1.3.0"></script>
    <script src="../js/pages/roadmap-chantiers.js?v=1.3.0"></script>
    <script src="../js/pages/mae.js?v=1.3.0"></script>
    <script src="../js/pages/params.js?v=1.3.0"></script>
    <script src="../js/app.js?v=1.3.0"></script>
</body>
</html>
